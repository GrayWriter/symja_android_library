<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head>
<title>SymjaTalk API</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="static/css/style.css" type="text/css" />
<link href="https://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet" />
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.js"></script>
<script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                jax: ["input/TeX", "output/HTML-CSS"],
                TeX: {
                    extensions: ["AMSmath.js", "AMSsymbols.js", "noErrors.js", "noUndefined.js"]
                },
                "HTML-CSS": {
                    minScaleAdjust: 100
                },
                menuSettings: {
                    context: "MathJax",
                    zoom: "Hover",
                    ALT: true
                },
                MathZoom: {
                    delay: 100
                },
                extensions: ["tex2jax.js"]
            });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML-full"></script>
</head>
<body>
	<div class="input">
		<form action="http://localhost:8080/api" method="get" id="calc">
			<input type="text" name="i" autocapitalize="off" autocorrect="off"
				id="id_i" /> <input class="input_field" type="submit" value="=" />

			<div>
<label><input type="checkbox" name="f" value="plaintext" checked />Plain text</label>
<label><input type="checkbox" name="f" value="sinput" checked />Symja input</label> 
<label><input type="checkbox" name="f" value="mathml" />MathML</label>
<label><input type="checkbox" name="f" value="latex" />LaTeX</label>
			</div>
		</form>
	</div>
	<div class="result" id="root">
		
	</div>

	<script>
		$("#calc")
				.submit(
						function(event) {
							event.preventDefault();
							var post_url = $(this).attr("action");
							var form_data = $(this).serialize();
							$
									.getJSON(
											post_url,
											form_data,
											function(data) {
												var queryresult = data.queryresult;
												var output = ' <div class="result_card">';
												for ( var i in queryresult.pods) {
													var pod = queryresult.pods[i];
													output += `<div class="card_title">${pod.title}</div>`;
													for ( var j in pod.subpods) {
														var subpod = pod.subpods[j];
														if (subpod.sinput){ 
														output += `<div class="cell_input"><pre>${subpod.sinput}</pre></div>`;
														}
														$
																.each(
																		subpod,
																		function(
																				k,
																				v) {
																			if (k == 'plaintext') {
																				output += `<div class="cell_output"><pre>${v}</pre></div>\n`;
																			} else if (k == 'markdown') {
																				output += `<div class="cell_output_plain" data-card-name="function_docs" data-variable="None"><pre>${v}</pre></div>`;
																			} else if (k == 'html') {
																				output += `<div class="cell_output_plain" data-card-name="function_docs" data-variable="None">${v}</div>`;
																			} else if (k == 'latex') {
																				output += `<div class="cell_output"><div>${v}</div></div>`;
																			} else if (k == 'jsxgraph') {
																				output += `<div class="cell_output"><div id="jsxgraph" style="width: 600px; height: 440px; margin: 0; padding: 0">${v}</div></div>\n`;
																			} else if (k == 'mathcell') {
																				output += `<div class="cell_output"><div id="mathcell" style="width: 600px; height: 440px; margin: 0; padding: 0">${v}</div></div>\n`;
																			} else if (k == 'plotly') {
																				output += `<div class="cell_output"><div id="plotly" style="width: 600px; height: 440px; margin: 0; padding: 0">${v}</div></div>\n`;
																			} else if (k == 'mathml') {
																				output += `<div class="cell_output"><div>${v}</div></div>`;
																			}
																		});
													}
												}
												output += ' </div>';
												document.getElementById("root").innerHTML = output;
											});
						});
	</script>
</body>
</html>